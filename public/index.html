<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Layers - Media Editor</title>
    <meta name="description" content="Layer-based media editor powered by the Noisemaker shader pipeline.">
    <meta name="keywords" content="layers, media, editor, shader, effects, blend modes">
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#333333">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Layers">
    <link rel="apple-touch-icon" href="/img/icon-192.svg">
    <!-- Preload fonts -->
    <link rel="preload" href="/fonts/Nunito.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="/fonts/CormorantUpright-SemiBold.woff2" as="font" type="font/woff2" crossorigin>
    <link rel="preload" href="https://fonts.noisedeck.app/fonts/nunito/Nunito[wght].woff2" as="font" type="font/woff2" crossorigin>
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/colors.css">
    <link rel="stylesheet" href="css/menu.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/layers.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/loading.css">
    <link rel="stylesheet" href="css/selection.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-modal">
            <div class="loading-brand">
                <svg class="loading-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 600" fill="currentColor">
                    <g transform="translate(0,600) scale(0.1,-0.1)">
                        <path d="M840 5478 c-10 -18 -120 -204 -244 -413 l-225 -380 1314 -3 c723 -1 1907 -1 2630 0 l1315 3 -236 390 c-130 215 -241 400 -247 413 l-10 22 -2139 0 -2139 0 -19 -32z"/>
                        <path d="M659 4118 c-111 -189 -222 -376 -246 -415 l-43 -73 2630 0 2630 0 -249 413 -249 412 -2135 3 -2135 2 -203 -342z"/>
                        <path d="M858 3403 c-8 -10 -90 -146 -183 -303 -92 -157 -199 -337 -237 -400 l-68 -115 1315 -3 c723 -1 1907 -1 2630 0 l1314 3 -251 418 -251 417 -2127 0 c-2013 0 -2128 -1 -2142 -17z"/>
                        <path d="M619 1959 c-134 -226 -245 -414 -247 -418 -1 -3 1179 -6 2623 -6 1743 0 2625 3 2625 10 0 6 -110 192 -244 415 l-244 405 -2135 3 -2134 2 -244 -411z"/>
                        <path d="M714 1073 c-81 -137 -191 -322 -245 -413 l-99 -165 1315 -3 c723 -1 1906 -1 2629 0 l1315 3 -248 410 -247 410 -2137 3 -2136 2 -147 -247z"/>
                    </g>
                </svg>
                <h1 class="loading-title"><span>Layers</span></h1>
                <p class="loading-tagline">Media Editor</p>
                <div class="loading-status">
                    <div class="loading-spinner"></div>
                    <span>Initializing</span>
                </div>
            </div>
        </div>
    </div>

    <div id="app">
        <!-- Menu Bar -->
        <div id="menu">
            <div id="menuBackdrop"></div>
            <div id="menuLeft">
                <!-- Logo Menu -->
                <div class="menu">
                    <div class="menu-title">
                        <svg id="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 600" fill="currentColor" style="height: 1.25em; width: 1.25em;">
                            <g transform="translate(0,600) scale(0.1,-0.1)">
                                <path d="M840 5478 c-10 -18 -120 -204 -244 -413 l-225 -380 1314 -3 c723 -1 1907 -1 2630 0 l1315 3 -236 390 c-130 215 -241 400 -247 413 l-10 22 -2139 0 -2139 0 -19 -32z"/>
                                <path d="M659 4118 c-111 -189 -222 -376 -246 -415 l-43 -73 2630 0 2630 0 -249 413 -249 412 -2135 3 -2135 2 -203 -342z"/>
                                <path d="M858 3403 c-8 -10 -90 -146 -183 -303 -92 -157 -199 -337 -237 -400 l-68 -115 1315 -3 c723 -1 1907 -1 2630 0 l1314 3 -251 418 -251 417 -2127 0 c-2013 0 -2128 -1 -2142 -17z"/>
                                <path d="M619 1959 c-134 -226 -245 -414 -247 -418 -1 -3 1179 -6 2623 -6 1743 0 2625 3 2625 10 0 6 -110 192 -244 415 l-244 405 -2135 3 -2134 2 -244 -411z"/>
                                <path d="M714 1073 c-81 -137 -191 -322 -245 -413 l-99 -165 1315 -3 c723 -1 1906 -1 2629 0 l1315 3 -248 410 -247 410 -2137 3 -2136 2 -147 -247z"/>
                            </g>
                        </svg>
                    </div>
                    <div class="menu-items hide">
                        <div id="aboutMenuItem">about Layers</div>
                    </div>
                </div>

                <!-- File Menu -->
                <div class="menu">
                    <div class="menu-title">file</div>
                    <div class="menu-items hide">
                        <div id="newMenuItem">new...</div>
                        <div id="openMenuItem">open...</div>
                        <hr class="menu-seperator">
                        <div id="saveProjectMenuItem">save project</div>
                        <div id="saveProjectAsMenuItem">save project as...</div>
                        <div id="loadProjectMenuItem">load project...</div>
                        <hr class="menu-seperator">
                        <div id="savePngMenuItem">quick save as png</div>
                        <div id="saveJpgMenuItem">quick save as jpg</div>
                    </div>
                </div>

                <!-- Edit Menu -->
                <div class="menu">
                    <div class="menu-title">edit</div>
                    <div class="menu-items hide">
                        <div id="undoMenuItem" class="disabled">undo<span class="menu-shortcut">&#8984;Z</span></div>
                        <div id="redoMenuItem" class="disabled">redo<span class="menu-shortcut">&#8984;&#8679;Z</span></div>
                    </div>
                </div>

                <!-- Image Menu -->
                <div class="menu" id="imageMenu">
                    <div class="menu-title">image</div>
                    <div class="menu-items hide">
                        <div id="cropToSelectionMenuItem" class="disabled">crop to selection</div>
                        <hr class="menu-seperator">
                        <div id="imageSizeMenuItem">image size...</div>
                        <div id="canvasSizeMenuItem">canvas size...</div>
                    </div>
                </div>

                <!-- Layer Menu -->
                <div class="menu">
                    <div class="menu-title">layer</div>
                    <div class="menu-items hide">
                        <div id="layerActionMenuItem">flatten image</div>
                        <hr class="menu-seperator">
                        <div id="deselectAllLayersMenuItem">deselect all layers</div>
                    </div>
                </div>

                <!-- View Menu -->
                <div class="menu">
                    <div class="menu-title">view</div>
                    <div class="menu-items hide">
                        <div id="zoomInMenuItem">zoom in</div>
                        <div id="zoomOutMenuItem">zoom out</div>
                        <hr class="menu-seperator">
                        <div id="fitInWindowMenuItem" class="checked">fit in window</div>
                        <hr class="menu-seperator">
                        <div id="zoom50MenuItem">50%</div>
                        <div id="zoom100MenuItem">100% (actual size)</div>
                        <div id="zoom200MenuItem">200%</div>
                    </div>
                </div>

            </div>

            <div id="menuRight">
                <button id="textToolBtn" class="menu-icon-btn" title="Add Text Layer"><span class="icon-material">text_fields</span></button>
                <div class="menu-separator"></div>
                <button id="cloneToolBtn" class="menu-icon-btn" title="Clone Tool"><span class="icon-material">approval</span></button>
                <button id="moveToolBtn" class="menu-icon-btn" title="Move Tool"><span class="icon-material">drag_pan</span></button>
                <div class="menu" id="selectionMenu">
                    <div class="menu-title menu-icon-btn" id="selectionToolBtn" title="Selection Tool">
                        <svg id="selectionToolIcon" class="selection-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1" stroke-dasharray="1 2" stroke-linecap="round">
                            <rect x="2" y="4" width="16" height="12"/>
                        </svg>
                    </div>
                    <div class="menu-items hide">
                        <div id="selectRectMenuItem" class="checked">
                            <svg class="selection-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1" stroke-dasharray="1 2" stroke-linecap="round">
                                <rect x="2" y="4" width="16" height="12"/>
                            </svg>
                            Box
                        </div>
                        <div id="selectOvalMenuItem">
                            <svg class="selection-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1" stroke-dasharray="1 2" stroke-linecap="round">
                                <ellipse cx="10" cy="10" rx="8" ry="6"/>
                            </svg>
                            Oval
                        </div>
                        <div id="selectLassoMenuItem">
                            <svg class="selection-icon" width="20" height="20" viewBox="0 0 1280 1280" fill="none" stroke="currentColor" stroke-width="64" stroke-dasharray="64 128" stroke-linecap="round">
                                <path transform="translate(0,1280) scale(1,-1)" d="M854 1221 c-21 -15 -48 -38 -58 -50 -24 -26 -51 -27 -107 -1 -62 28 -120 26 -148 -4 -21 -22 -22 -30 -16 -102 6 -73 5 -82 -17 -114 -30 -44 -68 -50 -134 -20 -72 33 -104 35 -137 10 -87 -69 -65 -144 60 -201 100 -45 115 -92 52 -163 -24 -27 -40 -36 -77 -41 -67 -9 -100 -24 -122 -55 -44 -62 -30 -134 37 -189 42 -35 75 -39 139 -17 47 17 201 31 237 22 13 -3 36 -23 51 -44 22 -32 26 -49 26 -104 0 -51 5 -71 21 -92 57 -73 267 13 330 135 30 59 26 140 -11 218 l-31 64 23 25 c20 21 29 23 71 18 42 -4 51 -2 79 23 26 23 32 36 35 82 5 63 -18 117 -57 136 -14 7 -48 13 -77 13 -43 0 -55 4 -71 25 -33 42 -10 90 61 126 55 29 63 53 48 151 -7 45 -19 94 -27 109 -37 73 -113 90 -180 40z"/>
                            </svg>
                            Lasso
                        </div>
                        <div id="selectPolygonMenuItem">
                            <svg class="selection-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="1" stroke-dasharray="1 2" stroke-linecap="round">
                                <polygon points="10,2 18,8 15,18 5,18 2,8"/>
                            </svg>
                            Polygon
                        </div>
                        <div id="selectWandMenuItem">
                            <span class="icon-material">auto_fix_high</span>
                            Magic Wand
                        </div>
                        <hr class="menu-seperator">
                        <div id="wandToleranceRow" class="menu-slider-row hide">
                            <label>Tolerance</label>
                            <input type="range" id="wandTolerance" min="0" max="255" value="32">
                            <span id="wandToleranceValue">32</span>
                        </div>
                    </div>
                </div>
                <div class="menu-separator"></div>
                <button id="playPauseBtn" class="menu-icon-btn icon-material" title="Play/Pause (Space)">pause</button>
            </div>
        </div>

        <!-- Canvas Panel -->
        <div id="canvas-panel">
            <div class="canvas-container">
                <canvas id="canvas" width="1024" height="1024"></canvas>
                <canvas id="selectionOverlay" width="1024" height="1024"></canvas>
            </div>
        </div>

        <!-- Layers Panel -->
        <div id="layers-panel">
            <div class="layers-header">
                <h2>Layers</h2>
                <div class="layers-header-buttons">
                    <button class="add-layer-btn" id="addLayerBtn" title="Add layer">
                        <span class="icon-material">add</span>
                    </button>
                </div>
            </div>
            <div class="layers-list">
                <layer-stack></layer-stack>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
